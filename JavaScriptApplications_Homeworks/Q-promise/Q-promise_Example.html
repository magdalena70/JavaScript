<!DOCTYPE html>
<html>
	<head>
		<title>Q promise - Example</title>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/q.js/0.9.2/q.js"></script>
	</head>
	<body>
		<div id="wrapper">
			<div id="date" style="color: green; font-size: 22px;"></div>
			<h1>Q promise - Example</h1>
			<button id="getReport">Get Report</button>
			<div id="startReport" style="color: green; font-size: 22px;"></div>
			<div id="result" style="color: red; font-size: 40px;"></div>
			<div id="endReport" style="color: green; font-size: 22px;"></div>
		</div>
		<script>
			var today = new Date();
			var dd = today.getDate();
			var mm = today.getMonth()+1; //January is 0!

			var yyyy = today.getFullYear();
			if(dd<10){
				dd='0'+dd
			} 
			if(mm<10){
				mm='0'+mm
			} 
			var today = dd+'/'+mm+'/'+yyyy;
			document.getElementById('date').innerHTML = today;
		
			function getReport(){
				var deferred = Q.defer();
				
				setTimeout(function(){
					var error = false;
					if(error){
						deferred.reject('Error');
					}else{
						document.getElementById('result').innerHTML = 'Cuccess';
						var getReportTime = new Date();
						deferred.resolve(getReportTime);
					}
				}, 2000);
				
				return deferred.promise;
			}
		
			function reportEnd(time){
				document.getElementById('endReport').innerHTML = 'End report at: ' + 
					time.getHours() + ':' + time.getMinutes() + ':' + time.getSeconds();
			}
			
			document.getElementById('getReport').onclick = function(){
				getReport()
					.then(reportEnd, function(error){
						console.error(error);
					},
						document.getElementById('startReport').innerHTML = 'Report start at: ' +
							new Date().getHours()+ ':'+ new Date().getMinutes() + ':' + new Date().getSeconds() +
							' - and will be ready after 2 seconds.'
					)
			}
		</script>
	</body>
</html>